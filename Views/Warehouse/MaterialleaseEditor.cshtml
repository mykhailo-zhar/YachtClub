@model ObjectViewModel<Materiallease>
<partial name="_Validation" />
<h5 class="bg-@Model.Theme text-white text-center p-2">@Model.Action</h5>
<script>
    function calcval() {
        $(show_price).empty(); $(show_price).append(($(PPU).val() * $(Count).val()).toFixed(2))
    }
    
</script>
<form asp-action="@Model.Action" method="post">

    @{
        Model.Option[0] = Model.Option[0] || Model.Object.Deliverydate != null;
    }

    <div class="form-group @Model.HideOnCreate">
        <label asp-for="Object.Id"></label>
        <input class="form-control" asp-for="Object.Id" readonly />
    </div>


    <div class="form-group @Model.AlwaysHidden">
        <label asp-for="Object.Startdate"></label>
        <div>
            <span asp-validation-for="Object.Startdate" class="text-danger"></span>
        </div>
        <input class="form-control" asp-for="Object.Startdate"
               readonly="@Model.ReadOnly" />
    </div>
    <hr />
    <div class="form-group @Model.HideOnCreate @Model.HideOnDelete">
        <div class="form-check form-switch position-relative d-flex" style="left: 20px">
            <div>
                @if (Model.Object.Deliverydate == null)
                {
                    <input asp-for="Option[0]" class="form-check-input" type="checkbox">
                }
                else
                {
                    <input asp-for="Option[0]" class="form-check-input" type="checkbox" checked disabled>
                }
            </div>
            <div>
                <label>Поставлено?</label>
            </div>

        </div>
    </div>

    <input hidden asp-for="Object.Deliverydate" />

    <div class="form-group">
        <label asp-for="Object.Priceperunit"></label>
        <div>
            <span asp-validation-for="Object.Priceperunit" class="text-danger"></span>
        </div>
        <input class="form-control" asp-for="Object.Priceperunit"
               id="PPU" oninput="calcval()"
               placeholder="Цена за единицу @Methods.MoneyCulture"
               readonly="@(Model.ReadOnly)" />
    </div>


    <div class="form-group">
        <label asp-for="Object.Count"></label>
        <div>
            <span asp-validation-for="Object.Count" class="text-danger"></span>
        </div>

        <input class="form-control" asp-for="Object.Count" min="1" 
               placeholder="Количество"
               readonly="@(Model.ReadOnly)"
               id="Count"
               oninput="calcval()"
               />

    </div>

    <div class="form-group @Model.HideOnDelete">
        <label>Предварительная цена</label>
        <div class="form-control" style="background-color: #dddddd" ><span id="show_price">@(Model.Object.Count * @Model.Object.Priceperunit)</span> @(@Methods.MoneyCulture)<span></span></div>

    </div>

    <input class="form-control" asp-for="Object.Overallprice" hidden
           readonly />

    <div class="@Model.DisplayNone(false, CRUD.Delete, CRUD.Edit)">

        <hr />

        <label>@typeof(Material).Name</label>

        <div class="form-group">
            <label>Изменить объект</label>
            <select class="form-control" asp-for="Object.Material"
                    asp-items="@((ViewData["Material"] as IEnumerable<Material> ?? Enumerable.Empty<Material>()).Select(p =>
    new SelectListItem
    {
        Text = $"{p.Name} {Methods.Message(p)}",
        Value = $"{p.Id}"
    }
))"
                    disabled="@Model.ReadOnly">
                <option value="" disabled selected>Выберите материал</option>
            </select>
        </div>

    </div>

    <hr />

    <div class="@Model.DisplayNone(false, CRUD.Delete, CRUD.Edit)">

        <label>@typeof(Seller).Name</label>

        <div class="form-group">
            <label>Изменить объект</label>
            <select class="form-control" asp-for="Object.Seller"
                    asp-items="@(new SelectList(ViewData["Seller"] as IEnumerable<Seller> ?? Enumerable.Empty<Seller>(), "Id", "Name"))"
                    disabled="@Model.ReadOnly">
                <option value="" disabled selected>Выберите поставщика</option>
            </select>
        </div>
        <div class="dropdown-divider"></div>

    </div>


    <partial name="_EditorBottomButtons" model="@(new EditorBottomButtonsViewModel {
        ShowAction = Model.ShowAction,
        Theme = Model.Theme,
        Action = Model.ActionObjectName,
        BackAction = Model.Object.GetType().Name
    })" />
</form>
